{"ast":null,"code":"var _jsxFileName = \"/home/alex/Documents/Work/ccfe/frontend/src/components/ViewProtocol.js\";\nimport { Component, renderToString } from 'react';\nimport { Link, NavLink, withRouter, useHistory } from \"react-router-dom\";\nimport store from \"../store/index\";\nimport { addUser } from \"../actions/index\";\nimport { browserHistory, Redirect } from 'react-router';\nimport React, { useState } from \"react\";\nimport { Button, FormGroup, FormControl, FormLabel } from \"react-bootstrap\";\nimport axios from 'axios';\nimport Cookies, { get } from \"js-cookie\";\nimport \"./ViewProtocol.css\";\nimport BeautyStars from 'beauty-stars';\nimport { HOST } from \"../constants/host.js\";\nimport { ADMIN_EMAIL } from \"../constants/admin_email.js\"; //var Rating = require('react-rating');\n\nclass ViewProtocol extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: Array(),\n      queried: false,\n      avgs: Array(),\n      allFields: [\"Protocol ID\", \"DOI\", \"Species\", \"Source Cell Type\", \"Target Cell Type\", \"Duration, days\", \"Medium\", \"Initial Culture\", \"Title\", \"Yield, %\", \"Comment On Yield\", \"Comment On Protocol\", \"Authors\", \"Chemicals\", \"Chemicals CID\", \"MOAs\", \"Transcription Factors\", \"Stress Factors\", \"Growth Factors\"],\n      ratings: [{\n        \"id\": \"first_rate\",\n        \"name\": \"Reproducibility\",\n        \"value\": 0,\n        \"description\": \"5 if you get markers output 100% of declared efficiency or higher\"\n      }, {\n        \"id\": \"second_rate\",\n        \"name\": \"Detalization depth\",\n        \"value\": 0,\n        \"description\": \"Was the protocol description from article deep enough?\"\n      }, {\n        \"id\": \"third_rate\",\n        \"name\": \"Functional maturity of cells\",\n        \"value\": 0,\n        \"description\": \"If induced cells fully reassemble target cells\"\n      }],\n      ready_to_rate: false\n    };\n\n    this.handleRequestData = () => {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': \"*\"\n        }\n      };\n      axios.get(HOST + \"/api/query/\" + this.props.match.params.protocolId, config).then(response => {\n        let response_data = response.data.response[0];\n        let chemicals_tmp = response_data[13].map((e, i) => {\n          let cid = response_data[14][i]; //console.log(\"CID: \", cid)\n          //console.log(\"INNER\", \"https://pubchem.ncbi.nlm.nih.gov/compound/\" + cid)\n\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 84\n            },\n            __self: this\n          }, \" * \", React.createElement(\"a\", {\n            href: \"https://pubchem.ncbi.nlm.nih.gov/compound/\" + cid,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 84\n            },\n            __self: this\n          }, \" \", e), \"  \");\n        }); //console.log(\"13: \", typeof( response_data[14][0]))\n\n        response_data[13] = chemicals_tmp;\n        this.setState({\n          data: response_data,\n          queried: true,\n          avgs: response.data.avgs\n        });\n        console.log(response.data.response);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.handleCangeRating = (i, value) => {\n      const ratings = [...this.state.ratings];\n      ratings[i][\"value\"] = value;\n      this.setState({\n        ratings: ratings\n      });\n    };\n\n    this.handleSubmit = () => {\n      const params = {\n        request: {\n          userName: Cookies.get(\"userName\"),\n          access_token: Cookies.get(\"access_token\"),\n          protocolId: this.state.data[0],\n          ratings: this.state.ratings\n        }\n      };\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': \"*\"\n        }\n      }; //https://cfm.mipt.ru:8443\n      // http://127.0.0.1:40001\n\n      axios.put(HOST + \"/api/rateProtocol\", params, config).then(response => {\n        console.log(\"RESPONSE\", response.data.response);\n\n        if (response.status !== 200) {\n          alert(\"Http(s) error occupied! Please contact \" + ADMIN_EMAIL);\n        } else if (response.data.response[0] == \"Undefined server-side error ocupied!\") {\n          alert(\"Undefined server-side error ocupied! Please contact \" + ADMIN_EMAIL);\n        } else if (response.data.response[0] == \"Authentification error\") {\n          alert(\"Authentifiction error occupied\");\n        } else if (response.data.response[0] == \"Database error\") {\n          alert(\"Database error ocupied! Please contact \" + ADMIN_EMAIL);\n        } else if (response.data.response[0] == \"An error occupied while trying to set ratings\") {\n          alert(\"Server-side error occupied! Please contact \" + ADMIN_EMAIL);\n        } else if (response.status == 200) {\n          alert(\"Protocol rated successfully!\");\n        }\n      }).catch(function (error) {\n        console.log(\"ERROR\", error);\n      });\n    };\n\n    this.componentDidMount = () => {\n      if (Cookies.get(\"access_token\") && Cookies.get(\"userName\")) {\n        this.setState({\n          ready_to_rate: true\n        });\n      }\n    };\n  }\n\n  render() {\n    if (!this.state.queried) {\n      this.handleRequestData();\n      console.log(typeof this.state.data);\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container viewprotocol \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, \"Protocol \")), React.createElement(\"div\", {\n      className: \"row center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      className: \"table table-hover table-bordered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Property\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"Value\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, this.state.data.map((field, idx) => {\n      if (idx !== 14) {\n        return React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, this.state.allFields[idx]), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }, Array.isArray(field) ? field : field, \" \"));\n      }\n    })))), React.createElement(\"div\", {\n      className: \"row center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Average protocol ratings \")), React.createElement(\"div\", {\n      className: \"row center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      className: \"table table-hover table-bordered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Measure\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Rate\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, this.state.avgs.map((row, i) => {\n      return React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, this.state.ratings[i].name), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, row));\n    })))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, this.state.ready_to_rate ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, \"Please rate this protocol if you have reproduced it!\"), this.state.ratings.map((row, i) => {\n      return React.createElement(\"div\", {\n        className: \"card row \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, row.name), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, \" \", row.description), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }), React.createElement(BeautyStars, {\n        value: row.value,\n        onChange: value => this.handleCangeRating(i, value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }), \" \", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }), \" \");\n    }), React.createElement(\"div\", {\n      className: \"row center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.handleSubmit,\n      className: \"btn btn-primary btn-lg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, \"Submit Ratings\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    })) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, \" \", React.createElement(Link, {\n      to: \"/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, \"Login or register\"), \" on website to rate protocols\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default withRouter(ViewProtocol);","map":{"version":3,"sources":["/home/alex/Documents/Work/ccfe/frontend/src/components/ViewProtocol.js"],"names":["Component","renderToString","Link","NavLink","withRouter","useHistory","store","addUser","browserHistory","Redirect","React","useState","Button","FormGroup","FormControl","FormLabel","axios","Cookies","get","BeautyStars","HOST","ADMIN_EMAIL","ViewProtocol","state","data","Array","queried","avgs","allFields","ratings","ready_to_rate","handleRequestData","config","headers","props","match","params","protocolId","then","response","response_data","chemicals_tmp","map","e","i","cid","setState","console","log","catch","error","handleCangeRating","value","handleSubmit","request","userName","access_token","put","status","alert","componentDidMount","render","field","idx","isArray","row","name","description"],"mappings":"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","sourcesContent":["import {Component, renderToString } from 'react';\nimport {Link, NavLink, withRouter, useHistory} from \"react-router-dom\"\nimport store from \"../store/index\"\nimport {addUser} from \"../actions/index\"\nimport { browserHistory, Redirect } from 'react-router';\nimport React, { useState } from \"react\";\nimport { Button, FormGroup, FormControl, FormLabel } from \"react-bootstrap\";\nimport axios from 'axios';\nimport Cookies, { get } from \"js-cookie\";\n\n\nimport \"./ViewProtocol.css\"\n\n\nimport BeautyStars from 'beauty-stars';\n\nimport {HOST} from \"../constants/host.js\"\nimport {ADMIN_EMAIL} from \"../constants/admin_email.js\"\n\n\n\n\n\n\n//var Rating = require('react-rating');\n\n\n\n\n\n\n\n\n\n\nclass ViewProtocol extends Component {\n    state = {\n        data: Array(),\n        queried: false,\n        avgs: Array(),\n        allFields:[\"Protocol ID\", \n                    \"DOI\",\n                    \"Species\",\n                    \"Source Cell Type\",\n                    \"Target Cell Type\",\n                    \"Duration, days\",\n                    \"Medium\",\n                    \"Initial Culture\",\n                    \"Title\",\n                    \"Yield, %\",\n                    \"Comment On Yield\",\n                    \"Comment On Protocol\",\n                    \"Authors\",\n                    \"Chemicals\",\n                    \"Chemicals CID\",\n                    \"MOAs\", \n                    \"Transcription Factors\",\n                    \"Stress Factors\",\n                    \"Growth Factors\"],\n        ratings: [\n            {\"id\": \"first_rate\",\"name\":\"Reproducibility\",  \"value\": 0, \"description\":\"5 if you get markers output 100% of declared efficiency or higher\"},\n            {\"id\": \"second_rate\",\"name\": \"Detalization depth\",  \"value\": 0, \"description\":\"Was the protocol description from article deep enough?\"},\n            {\"id\": \"third_rate\", \"name\":\"Functional maturity of cells\", \"value\": 0, \"description\":\"If induced cells fully reassemble target cells\"}\n\n        \n    ],\n    ready_to_rate: false\n    }\n    handleRequestData = () => {\n        const config = { \n            headers: {'Content-Type': 'application/json',\n                      'Access-Control-Allow-Origin':\"*\"} \n            };\n            \n       axios.get(HOST + \"/api/query/\" + this.props.match.params.protocolId,\n         config).then((response) => {\n             let response_data = response.data.response[0];\n\n             let chemicals_tmp = response_data[13].map((e, i) => {\n                 let cid = response_data[14][i];\n\n                 //console.log(\"CID: \", cid)\n                 //console.log(\"INNER\", \"https://pubchem.ncbi.nlm.nih.gov/compound/\" + cid)\n             return <div> * <a href= {\"https://pubchem.ncbi.nlm.nih.gov/compound/\" + cid }> {e}</a>  </div>\n             })\n            //console.log(\"13: \", typeof( response_data[14][0]))\n             response_data[13] = chemicals_tmp;\n             this.setState({\n                 data: response_data,\n                 queried: true,\n                 avgs: response.data.avgs\n             })\n             \n             console.log(response.data.response)\n         })\n         .catch((error) => {\n             console.log(error)\n         }) \n         \n         \n         \n        \n         \n    }\n\n\n\n    handleCangeRating = (i, value) => {\n        const ratings = [...this.state.ratings]\n        ratings[i][\"value\"] = value\n        this.setState({\n            ratings: ratings\n        })\n\n\n\n\n    }\n\n\n    handleSubmit = ( ) => {\n        const params = {\n            request: {\n            userName: Cookies.get(\"userName\"),\n            access_token: Cookies.get(\"access_token\"),\n            protocolId: this.state.data[0],\n            ratings: this.state.ratings ,\n            }\n          }\n        const config = { \n            headers: {'Content-Type': 'application/json',\n                      'Access-Control-Allow-Origin':\"*\"} \n            };\n        //https://cfm.mipt.ru:8443\n        // http://127.0.0.1:40001\n        axios.put(HOST + \"/api/rateProtocol\", \n        params,\n        config)\n        .then((response) => {\n          console.log(\"RESPONSE\", response.data.response);\n          if (response.status !== 200) {\n              alert(\"Http(s) error occupied! Please contact \" + ADMIN_EMAIL)\n          } else if (response.data.response[0] == \"Undefined server-side error ocupied!\") {\n              alert(\"Undefined server-side error ocupied! Please contact \" + ADMIN_EMAIL)  \n          } else if(response.data.response[0] == \"Authentification error\"){\n              alert (\"Authentifiction error occupied\")\n         } else if (response.data.response[0] == \"Database error\") {\n             alert(\"Database error ocupied! Please contact \" + ADMIN_EMAIL)\n         } else if (response.data.response[0] == \"An error occupied while trying to set ratings\") {\n             alert(\"Server-side error occupied! Please contact \" + ADMIN_EMAIL)\n         }\n          else if (response.status == 200){\n              alert(\"Protocol rated successfully!\")\n          }\n        }).catch(function (error) {\n          console.log(\"ERROR\", error);\n        })\n    }\n\n    componentDidMount = () => {\n        if (Cookies.get(\"access_token\")  && Cookies.get(\"userName\")) {\n            this.setState({\n                ready_to_rate: true\n            })\n        }\n\n    }\n\n    render () {\n        if (!this.state.queried) {\n        this.handleRequestData();\n        console.log(typeof(this.state.data))\n        }\n    return (\n        <div className=\"container viewprotocol \">\n            <div className=\"row center\">\n            <h4 className=\"center\">Protocol </h4>\n            </div>\n            <div className=\"row center\">\n            <table className=\"table table-hover table-bordered\">\n            <thead>\n            <tr>\n                <th>Property</th>\n                <th>Value</th>\n            </tr>\n            </thead>\n            <tbody>\n            {this.state.data.map (\n                (field, idx) => {\n                    if (idx !== 14) {\n                    return  <tr>\n                        <td>{this.state.allFields[idx]}</td>\n                        <td>{Array.isArray(field) ? field: field} </td> \n                        </tr>\n                    }\n                }\n            ) }\n            </tbody>\n\n            </table>\n            </div>\n            <div className=\"row center\">\n                <h3>Average protocol ratings </h3> \n            </div>\n            <div className=\"row center\">\n                <table className=\"table table-hover table-bordered\">\n                <thead>\n                    <tr>\n                        <th>Measure</th>\n                        <th>Rate</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {this.state.avgs.map((row, i) => {\n                        return <tr>\n                            <td>{this.state.ratings[i].name}</td>\n                            <td>{row}</td>\n                        </tr>\n                    })}\n\n\n                </tbody>\n                </table>             \n\n\n            </div>\n            <div >\n            {this.state.ready_to_rate ? (<div>\n                <h4>Please rate this protocol if you have reproduced it!</h4>\n                {this.state.ratings.map((row, i) => {\n             return <div className=\"card row \">\n                 \n                 <h5>{row.name}</h5>\n                 <br></br>\n                <div> {row.description}</div>\n                <br></br>\n                <br></br>\n                 <BeautyStars\n                value={row.value}\n                onChange={value => this.handleCangeRating(i, value)}\n      /> <br></br> </div>}\n                )}  \n                <div className=\"row center\">\n                <button\n                type=\"button\"\n                onClick={this.handleSubmit}\n                className=\"btn btn-primary btn-lg\"\n                >\n                Submit Ratings\n                </button>\n                </div>\n                <br></br>\n                <br></br>\n                <br></br>\n                \n                </div>) : (<div>\n                <h4> <Link to=\"/login\" >Login or register</Link> on website to rate protocols</h4>\n                <br></br>\n                <br></br>\n                <br></br>\n                </div>)}\n\n            </div>\n            \n            \n\n        </div>\n    )\n            }\n}\n\nexport default withRouter(ViewProtocol);"]},"metadata":{},"sourceType":"module"}
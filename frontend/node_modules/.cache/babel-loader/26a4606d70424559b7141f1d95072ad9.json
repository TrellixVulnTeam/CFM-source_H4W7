{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar actions_1 = require(\"../../actions\");\n\nvar type_validate_1 = require(\"../type-validate\");\n\nvar utils_1 = require(\"../utils\");\n\nfunction matchesAbsolutePath(value) {\n  return value.match('^https?://') ? undefined : [{\n    value: value,\n    error: 'invalid_absolute_url',\n    message: 'expected string to start with `https://` or `http://`'\n  }];\n}\n\nexports.matchesAbsolutePath = matchesAbsolutePath;\n\nfunction getSectionSchema(payload) {\n  var isProductVariant = payload && payload.section && payload.section.resource && payload.section.name === actions_1.Redirect.ResourceType.Product;\n  var resourceSchema = {\n    create: type_validate_1.makeOptional(type_validate_1.matchesBoolean()),\n    id: type_validate_1.makeOptional(type_validate_1.matchesString())\n  };\n\n  var productVariantSchema = __assign({}, resourceSchema, {\n    variant: type_validate_1.makeOptional(type_validate_1.matchesObject(resourceSchema))\n  });\n\n  return type_validate_1.matchesObject({\n    section: type_validate_1.matchesObject({\n      name: type_validate_1.matchesEnum(actions_1.Redirect.ResourceType),\n      resource: type_validate_1.makeOptional(type_validate_1.matchesObject(isProductVariant ? productVariantSchema : resourceSchema))\n    })\n  });\n}\n\nexports.getSectionSchema = getSectionSchema;\n\nfunction validateAction(action) {\n  var newContextSchema = type_validate_1.matchesObject({\n    newContext: type_validate_1.makeOptional(type_validate_1.matchesBoolean())\n  });\n  var actionType = actions_1.Redirect.ActionType;\n  var schema;\n\n  switch (action.type) {\n    case actions_1.History.ActionType.PUSH:\n    case actions_1.History.ActionType.REPLACE:\n      actionType = actions_1.History.ActionType;\n      schema = utils_1.relativePathSchema;\n      break;\n\n    case actions_1.Redirect.ActionType.APP:\n      schema = utils_1.relativePathSchema;\n      break;\n\n    case actions_1.Redirect.ActionType.REMOTE:\n      schema = type_validate_1.composeSchemas(type_validate_1.matchesObject({\n        url: type_validate_1.composeSchemas(type_validate_1.matchesString(), function (value) {\n          return matchesAbsolutePath(value);\n        })\n      }), newContextSchema);\n      break;\n\n    case actions_1.Redirect.ActionType.ADMIN_PATH:\n      schema = type_validate_1.composeSchemas(utils_1.relativePathSchema, newContextSchema);\n      break;\n\n    case actions_1.Redirect.ActionType.ADMIN_SECTION:\n      schema = type_validate_1.composeSchemas(getSectionSchema(action.payload), newContextSchema);\n      break;\n  }\n\n  return type_validate_1.validate(action, utils_1.createActionValidator(actionType, schema));\n}\n\nexports.validateAction = validateAction;","map":{"version":3,"sources":["/home/alex/Documents/Work/ccfe/frontend/node_modules/@shopify/app-bridge/validate/actions/navigation.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineProperty","exports","value","actions_1","require","type_validate_1","utils_1","matchesAbsolutePath","match","undefined","error","message","getSectionSchema","payload","isProductVariant","section","resource","name","Redirect","ResourceType","Product","resourceSchema","create","makeOptional","matchesBoolean","id","matchesString","productVariantSchema","variant","matchesObject","matchesEnum","validateAction","action","newContextSchema","newContext","actionType","ActionType","schema","type","History","PUSH","REPLACE","relativePathSchema","APP","REMOTE","composeSchemas","url","ADMIN_PATH","ADMIN_SECTION","validate","createActionValidator"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar actions_1 = require(\"../../actions\");\nvar type_validate_1 = require(\"../type-validate\");\nvar utils_1 = require(\"../utils\");\nfunction matchesAbsolutePath(value) {\n    return value.match('^https?://')\n        ? undefined\n        : [\n            {\n                value: value,\n                error: 'invalid_absolute_url',\n                message: 'expected string to start with `https://` or `http://`',\n            },\n        ];\n}\nexports.matchesAbsolutePath = matchesAbsolutePath;\nfunction getSectionSchema(payload) {\n    var isProductVariant = payload &&\n        payload.section &&\n        payload.section.resource &&\n        payload.section.name === actions_1.Redirect.ResourceType.Product;\n    var resourceSchema = {\n        create: type_validate_1.makeOptional(type_validate_1.matchesBoolean()),\n        id: type_validate_1.makeOptional(type_validate_1.matchesString()),\n    };\n    var productVariantSchema = __assign({}, resourceSchema, { variant: type_validate_1.makeOptional(type_validate_1.matchesObject(resourceSchema)) });\n    return type_validate_1.matchesObject({\n        section: type_validate_1.matchesObject({\n            name: type_validate_1.matchesEnum(actions_1.Redirect.ResourceType),\n            resource: type_validate_1.makeOptional(type_validate_1.matchesObject(isProductVariant ? productVariantSchema : resourceSchema)),\n        }),\n    });\n}\nexports.getSectionSchema = getSectionSchema;\nfunction validateAction(action) {\n    var newContextSchema = type_validate_1.matchesObject({ newContext: type_validate_1.makeOptional(type_validate_1.matchesBoolean()) });\n    var actionType = actions_1.Redirect.ActionType;\n    var schema;\n    switch (action.type) {\n        case actions_1.History.ActionType.PUSH:\n        case actions_1.History.ActionType.REPLACE:\n            actionType = actions_1.History.ActionType;\n            schema = utils_1.relativePathSchema;\n            break;\n        case actions_1.Redirect.ActionType.APP:\n            schema = utils_1.relativePathSchema;\n            break;\n        case actions_1.Redirect.ActionType.REMOTE:\n            schema = type_validate_1.composeSchemas(type_validate_1.matchesObject({\n                url: type_validate_1.composeSchemas(type_validate_1.matchesString(), function (value) { return matchesAbsolutePath(value); }),\n            }), newContextSchema);\n            break;\n        case actions_1.Redirect.ActionType.ADMIN_PATH:\n            schema = type_validate_1.composeSchemas(utils_1.relativePathSchema, newContextSchema);\n            break;\n        case actions_1.Redirect.ActionType.ADMIN_SECTION:\n            schema = type_validate_1.composeSchemas(getSectionSchema(action.payload), newContextSchema);\n            break;\n    }\n    return type_validate_1.validate(action, utils_1.createActionValidator(actionType, schema));\n}\nexports.validateAction = validateAction;\n"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar type_validate_1 = require(\"../type-validate\");\n\nvar utils_1 = require(\"../utils\");\n\nvar button_1 = require(\"./button\");\n\nvar Modal_1 = require(\"../../actions/Modal\");\n\nexports.ActionType = Modal_1.ActionType;\n\nvar Button_1 = require(\"../../actions/Button\");\n\nvar safe_redirect_1 = require(\"../safe-redirect\");\n\nfunction matchesSafeOrigin(value, localOrigin) {\n  var hostName;\n\n  try {\n    hostName = new URL(localOrigin).hostname;\n  } catch (error) {\n    return [{\n      error: 'invalid_app_origin',\n      value: localOrigin,\n      message: \"Provided value for app origin: `\" + localOrigin + \"` is invalid\"\n    }];\n  }\n\n  var isSafeSrc = safe_redirect_1.isSafe(value, {\n    requireAbsolute: true,\n    requireSSL: true,\n    whitelist: [hostName]\n  });\n\n  if (!isSafeSrc) {\n    return [{\n      error: 'unsafe_origin',\n      value: value,\n      message: \"Provided value is not whitelisted\"\n    }];\n  }\n}\n\nfunction matchesSize() {\n  return function (value) {\n    var values = [Modal_1.Size.Small, Modal_1.Size.Medium, Modal_1.Size.Large];\n\n    if (values.includes(value)) {\n      return;\n    }\n\n    var message = \"expected:\" + values.map(function (val) {\n      return \"`\" + val + \"`\";\n    }).join(' or ');\n\n    if (value === Modal_1.Size.Full) {\n      message += \". Size `\" + value + \"` is deprecated as of version 1.6.5 and will fall back to size `medium`\";\n    }\n\n    if (value === Modal_1.Size.Auto) {\n      message += \". Size `\" + value + \"` is deprecated as of version 1.12.x and will fall back to size `medium`. Use the `setUpModalAutoSizing` utility from `app-bridge-utils` instead\";\n    }\n\n    return [{\n      error: 'invalid_enum_value',\n      value: value,\n      message: message\n    }];\n  };\n}\n\nfunction getModalSchema(props, localOrigin) {\n  if (props === void 0) {\n    props = {};\n  }\n\n  var baseModalSchema = type_validate_1.matchesObject({\n    title: type_validate_1.makeOptional(type_validate_1.matchesString()),\n    footer: type_validate_1.makeOptional(type_validate_1.matchesObject({\n      buttons: type_validate_1.matchesObject({\n        primary: type_validate_1.makeOptional(button_1.buttonSchemaWithId),\n        secondary: type_validate_1.makeOptional(type_validate_1.matchesArray(button_1.buttonSchemaWithId))\n      })\n    })),\n    size: type_validate_1.makeOptional(matchesSize())\n  });\n\n  if (Modal_1.isIframeModal(props)) {\n    if (props.url) {\n      var urlSchema = type_validate_1.matchesObject({\n        url: type_validate_1.composeSchemas(type_validate_1.matchesString(), function (value) {\n          return value.startsWith('https://') ? undefined : [{\n            error: 'invalid_secure_url',\n            value: value,\n            message: 'expected string to start with `https://`'\n          }];\n        }, function (value) {\n          return localOrigin ? matchesSafeOrigin(value, localOrigin) : undefined;\n        })\n      });\n      return type_validate_1.composeSchemas(baseModalSchema, urlSchema);\n    }\n\n    return type_validate_1.composeSchemas(baseModalSchema, utils_1.relativePathSchema);\n  }\n\n  return type_validate_1.composeSchemas(baseModalSchema, type_validate_1.matchesObject({\n    message: type_validate_1.matchesString()\n  }));\n}\n\nfunction validateProps(props, localOrigin) {\n  return type_validate_1.validate(props, getModalSchema(props, localOrigin));\n}\n\nexports.validateProps = validateProps;\n\nfunction validateAction(action, localOrigin) {\n  var schema = getModalSchema(action.payload, localOrigin);\n\n  switch (action.type) {\n    case Modal_1.ActionType.OPEN:\n    case Modal_1.ActionType.UPDATE:\n      return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType, schema, true, action.type === Modal_1.ActionType.UPDATE));\n\n    case Modal_1.ActionType.FOOTER_BUTTON_CLICK:\n      return button_1.validateAction(__assign({}, action, {\n        type: Button_1.ActionType.CLICK\n      }));\n\n    case Modal_1.ActionType.FOOTER_BUTTON_UPDATE:\n      return button_1.validateAction(__assign({}, action, {\n        type: Button_1.ActionType.UPDATE\n      }));\n\n    case Modal_1.ActionType.CLOSE:\n    default:\n      return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType));\n  }\n}\n\nexports.validateAction = validateAction;","map":{"version":3,"sources":["/home/alex/Documents/Work/ccfe/frontend/node_modules/@shopify/app-bridge/validate/actions/modal.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineProperty","exports","value","type_validate_1","require","utils_1","button_1","Modal_1","ActionType","Button_1","safe_redirect_1","matchesSafeOrigin","localOrigin","hostName","URL","hostname","error","message","isSafeSrc","isSafe","requireAbsolute","requireSSL","whitelist","matchesSize","values","Size","Small","Medium","Large","includes","map","val","join","Full","Auto","getModalSchema","props","baseModalSchema","matchesObject","title","makeOptional","matchesString","footer","buttons","primary","buttonSchemaWithId","secondary","matchesArray","size","isIframeModal","url","urlSchema","composeSchemas","startsWith","undefined","relativePathSchema","validateProps","validate","validateAction","action","schema","payload","type","OPEN","UPDATE","createActionValidator","FOOTER_BUTTON_CLICK","CLICK","FOOTER_BUTTON_UPDATE","CLOSE"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar type_validate_1 = require(\"../type-validate\");\nvar utils_1 = require(\"../utils\");\nvar button_1 = require(\"./button\");\nvar Modal_1 = require(\"../../actions/Modal\");\nexports.ActionType = Modal_1.ActionType;\nvar Button_1 = require(\"../../actions/Button\");\nvar safe_redirect_1 = require(\"../safe-redirect\");\nfunction matchesSafeOrigin(value, localOrigin) {\n    var hostName;\n    try {\n        hostName = new URL(localOrigin).hostname;\n    }\n    catch (error) {\n        return [\n            {\n                error: 'invalid_app_origin',\n                value: localOrigin,\n                message: \"Provided value for app origin: `\" + localOrigin + \"` is invalid\",\n            },\n        ];\n    }\n    var isSafeSrc = safe_redirect_1.isSafe(value, {\n        requireAbsolute: true,\n        requireSSL: true,\n        whitelist: [hostName],\n    });\n    if (!isSafeSrc) {\n        return [\n            {\n                error: 'unsafe_origin',\n                value: value,\n                message: \"Provided value is not whitelisted\",\n            },\n        ];\n    }\n}\nfunction matchesSize() {\n    return function (value) {\n        var values = [Modal_1.Size.Small, Modal_1.Size.Medium, Modal_1.Size.Large];\n        if (values.includes(value)) {\n            return;\n        }\n        var message = \"expected:\" + values.map(function (val) { return \"`\" + val + \"`\"; }).join(' or ');\n        if (value === Modal_1.Size.Full) {\n            message += \". Size `\" + value + \"` is deprecated as of version 1.6.5 and will fall back to size `medium`\";\n        }\n        if (value === Modal_1.Size.Auto) {\n            message += \". Size `\" + value + \"` is deprecated as of version 1.12.x and will fall back to size `medium`. Use the `setUpModalAutoSizing` utility from `app-bridge-utils` instead\";\n        }\n        return [\n            {\n                error: 'invalid_enum_value',\n                value: value,\n                message: message,\n            },\n        ];\n    };\n}\nfunction getModalSchema(props, localOrigin) {\n    if (props === void 0) { props = {}; }\n    var baseModalSchema = type_validate_1.matchesObject({\n        title: type_validate_1.makeOptional(type_validate_1.matchesString()),\n        footer: type_validate_1.makeOptional(type_validate_1.matchesObject({\n            buttons: type_validate_1.matchesObject({\n                primary: type_validate_1.makeOptional(button_1.buttonSchemaWithId),\n                secondary: type_validate_1.makeOptional(type_validate_1.matchesArray(button_1.buttonSchemaWithId)),\n            }),\n        })),\n        size: type_validate_1.makeOptional(matchesSize()),\n    });\n    if (Modal_1.isIframeModal(props)) {\n        if (props.url) {\n            var urlSchema = type_validate_1.matchesObject({\n                url: type_validate_1.composeSchemas(type_validate_1.matchesString(), function (value) {\n                    return value.startsWith('https://')\n                        ? undefined\n                        : [\n                            {\n                                error: 'invalid_secure_url',\n                                value: value,\n                                message: 'expected string to start with `https://`',\n                            },\n                        ];\n                }, function (value) { return (localOrigin ? matchesSafeOrigin(value, localOrigin) : undefined); }),\n            });\n            return type_validate_1.composeSchemas(baseModalSchema, urlSchema);\n        }\n        return type_validate_1.composeSchemas(baseModalSchema, utils_1.relativePathSchema);\n    }\n    return type_validate_1.composeSchemas(baseModalSchema, type_validate_1.matchesObject({ message: type_validate_1.matchesString() }));\n}\nfunction validateProps(props, localOrigin) {\n    return type_validate_1.validate(props, getModalSchema(props, localOrigin));\n}\nexports.validateProps = validateProps;\nfunction validateAction(action, localOrigin) {\n    var schema = getModalSchema(action.payload, localOrigin);\n    switch (action.type) {\n        case Modal_1.ActionType.OPEN:\n        case Modal_1.ActionType.UPDATE:\n            return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType, schema, true, action.type === Modal_1.ActionType.UPDATE));\n        case Modal_1.ActionType.FOOTER_BUTTON_CLICK:\n            return button_1.validateAction(__assign({}, action, { type: Button_1.ActionType.CLICK }));\n        case Modal_1.ActionType.FOOTER_BUTTON_UPDATE:\n            return button_1.validateAction(__assign({}, action, { type: Button_1.ActionType.UPDATE }));\n        case Modal_1.ActionType.CLOSE:\n        default:\n            return type_validate_1.validate(action, utils_1.createActionValidator(Modal_1.ActionType));\n    }\n}\nexports.validateAction = validateAction;\n"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar client_1 = require(\"../client\");\n\nvar actions_1 = require(\"../actions\");\n\nvar Error_1 = require(\"../actions/Error\");\n\nvar actions_2 = require(\"./actions\");\n\nvar type_validate_1 = require(\"./type-validate\");\n\nvar utils_1 = require(\"./utils\");\n\nvar helper_1 = require(\"../actions/helper\");\n\nfunction updateValidator(localOrigin, group, options) {\n  switch (group) {\n    case actions_1.Group.Button:\n      return actions_2.Button.validateProps(options);\n\n    case actions_1.Group.ButtonGroup:\n      return actions_2.ButtonGroup.validateProps(options);\n\n    case actions_1.Group.Modal:\n      return actions_2.Modal.validateProps(options, localOrigin);\n\n    case actions_1.Group.Menu:\n      return actions_2.Menu.validateProps(options);\n\n    case actions_1.Group.Link:\n      return actions_2.Link.validateProps(options);\n\n    case actions_1.Group.TitleBar:\n      return actions_2.TitleBar.validateProps(options);\n\n    case actions_1.Group.ResourcePicker:\n      return actions_2.ResourcePicker.validateProps(options);\n\n    case actions_1.Group.Toast:\n      return actions_2.Toast.validateProps(options);\n\n    case actions_1.Group.ContextualSaveBar:\n      return actions_2.ContextualSaveBar.validateProps(options);\n  }\n}\n\nfunction dispatchPayloadValidator(action, localOrigin) {\n  switch (action.group) {\n    case actions_1.Group.Button:\n      return actions_2.Button.validateAction(action);\n\n    case actions_1.Group.ButtonGroup:\n      return actions_2.ButtonGroup.validateAction(action);\n\n    case actions_1.Group.Modal:\n      return actions_2.Modal.validateAction(action, localOrigin);\n\n    case actions_1.Group.Menu:\n      return actions_2.Menu.validateAction(action);\n\n    case actions_1.Group.TitleBar:\n      return actions_2.TitleBar.validateAction(action);\n\n    case actions_1.Group.ResourcePicker:\n      return actions_2.ResourcePicker.validateAction(action);\n\n    case actions_1.Group.Loading:\n      return actions_2.Loading.validateAction(action);\n\n    case actions_1.Group.Toast:\n      return actions_2.Toast.validateAction(action);\n\n    case actions_1.Group.Cart:\n      return actions_2.Cart.validateAction(action);\n\n    case actions_1.Group.Navigation:\n      return actions_2.Navigation.validateAction(action);\n\n    case actions_1.Group.Print:\n      return actions_2.Print.validateAction(action);\n\n    case actions_1.Group.Scanner:\n      return actions_2.Scanner.validateAction(action);\n\n    case actions_1.Group.Fullscreen:\n      return actions_2.Fullscreen.validateAction(action);\n\n    case actions_1.Group.ContextualSaveBar:\n      return actions_2.ContextualSaveBar.validateAction(action);\n\n    case actions_1.Group.Link:\n      return actions_2.Link.validateAction(action);\n  }\n}\n\nfunction dispatchValidator(action, origin) {\n  var errors = type_validate_1.validate(action, type_validate_1.matchesObject({\n    group: type_validate_1.matchesEnum(actions_1.Group, {\n      message: function (_, value) {\n        return \"Unknown or unsupported action group `\" + value + \"`\";\n      }\n    }),\n    version: type_validate_1.matchesString()\n  }));\n\n  if (errors) {\n    return Error_1.invalidAction(action, utils_1.actionMessage(errors));\n  }\n\n  var payloadErrors = dispatchPayloadValidator(action, origin);\n  return payloadErrors ? Error_1.invalidPayload(action, utils_1.actionMessage(payloadErrors)) : action;\n}\n\nexports.connectValidatorToUpdateHook = function (next) {\n  return function (options) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    } // The group should be staticly set to the default initial group as certain components\n    // (ex. Button and ButtonGroup) can be dynamically grouped under a new group (ex. TitleBar)\n    // We accept partial options so the validator should be called on merged new and old options\n\n\n    var mergedOptions = helper_1.getMergedProps(this.options, options);\n    var errors = updateValidator(this.app.localOrigin, this.defaultGroup, mergedOptions);\n\n    if (errors) {\n      throw Error_1.fromAction(utils_1.actionMessage(errors), Error_1.ActionType.INVALID_OPTIONS);\n    }\n\n    return next.apply(void 0, [options].concat(args));\n  };\n};\n\nexports.connectValidatorToDispatchHook = function (next) {\n  return function (action) {\n    var finalAction = dispatchValidator(action, this.localOrigin);\n    return next(finalAction);\n  };\n};\n\nexports.validatorMiddleware = function (hooks) {\n  hooks.set(client_1.LifecycleHook.UpdateAction, exports.connectValidatorToUpdateHook);\n  hooks.set(client_1.LifecycleHook.DispatchAction, exports.connectValidatorToDispatchHook);\n};","map":{"version":3,"sources":["/home/alex/Documents/Work/ccfe/frontend/node_modules/@shopify/app-bridge/validate/validator.js"],"names":["Object","defineProperty","exports","value","client_1","require","actions_1","Error_1","actions_2","type_validate_1","utils_1","helper_1","updateValidator","localOrigin","group","options","Group","Button","validateProps","ButtonGroup","Modal","Menu","Link","TitleBar","ResourcePicker","Toast","ContextualSaveBar","dispatchPayloadValidator","action","validateAction","Loading","Cart","Navigation","Print","Scanner","Fullscreen","dispatchValidator","origin","errors","validate","matchesObject","matchesEnum","message","_","version","matchesString","invalidAction","actionMessage","payloadErrors","invalidPayload","connectValidatorToUpdateHook","next","args","_i","arguments","length","mergedOptions","getMergedProps","app","defaultGroup","fromAction","ActionType","INVALID_OPTIONS","apply","concat","connectValidatorToDispatchHook","finalAction","validatorMiddleware","hooks","set","LifecycleHook","UpdateAction","DispatchAction"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar client_1 = require(\"../client\");\nvar actions_1 = require(\"../actions\");\nvar Error_1 = require(\"../actions/Error\");\nvar actions_2 = require(\"./actions\");\nvar type_validate_1 = require(\"./type-validate\");\nvar utils_1 = require(\"./utils\");\nvar helper_1 = require(\"../actions/helper\");\nfunction updateValidator(localOrigin, group, options) {\n    switch (group) {\n        case actions_1.Group.Button:\n            return actions_2.Button.validateProps(options);\n        case actions_1.Group.ButtonGroup:\n            return actions_2.ButtonGroup.validateProps(options);\n        case actions_1.Group.Modal:\n            return actions_2.Modal.validateProps(options, localOrigin);\n        case actions_1.Group.Menu:\n            return actions_2.Menu.validateProps(options);\n        case actions_1.Group.Link:\n            return actions_2.Link.validateProps(options);\n        case actions_1.Group.TitleBar:\n            return actions_2.TitleBar.validateProps(options);\n        case actions_1.Group.ResourcePicker:\n            return actions_2.ResourcePicker.validateProps(options);\n        case actions_1.Group.Toast:\n            return actions_2.Toast.validateProps(options);\n        case actions_1.Group.ContextualSaveBar:\n            return actions_2.ContextualSaveBar.validateProps(options);\n    }\n}\nfunction dispatchPayloadValidator(action, localOrigin) {\n    switch (action.group) {\n        case actions_1.Group.Button:\n            return actions_2.Button.validateAction(action);\n        case actions_1.Group.ButtonGroup:\n            return actions_2.ButtonGroup.validateAction(action);\n        case actions_1.Group.Modal:\n            return actions_2.Modal.validateAction(action, localOrigin);\n        case actions_1.Group.Menu:\n            return actions_2.Menu.validateAction(action);\n        case actions_1.Group.TitleBar:\n            return actions_2.TitleBar.validateAction(action);\n        case actions_1.Group.ResourcePicker:\n            return actions_2.ResourcePicker.validateAction(action);\n        case actions_1.Group.Loading:\n            return actions_2.Loading.validateAction(action);\n        case actions_1.Group.Toast:\n            return actions_2.Toast.validateAction(action);\n        case actions_1.Group.Cart:\n            return actions_2.Cart.validateAction(action);\n        case actions_1.Group.Navigation:\n            return actions_2.Navigation.validateAction(action);\n        case actions_1.Group.Print:\n            return actions_2.Print.validateAction(action);\n        case actions_1.Group.Scanner:\n            return actions_2.Scanner.validateAction(action);\n        case actions_1.Group.Fullscreen:\n            return actions_2.Fullscreen.validateAction(action);\n        case actions_1.Group.ContextualSaveBar:\n            return actions_2.ContextualSaveBar.validateAction(action);\n        case actions_1.Group.Link:\n            return actions_2.Link.validateAction(action);\n    }\n}\nfunction dispatchValidator(action, origin) {\n    var errors = type_validate_1.validate(action, type_validate_1.matchesObject({\n        group: type_validate_1.matchesEnum(actions_1.Group, {\n            message: function (_, value) { return \"Unknown or unsupported action group `\" + value + \"`\"; },\n        }),\n        version: type_validate_1.matchesString(),\n    }));\n    if (errors) {\n        return Error_1.invalidAction(action, utils_1.actionMessage(errors));\n    }\n    var payloadErrors = dispatchPayloadValidator(action, origin);\n    return payloadErrors ? Error_1.invalidPayload(action, utils_1.actionMessage(payloadErrors)) : action;\n}\nexports.connectValidatorToUpdateHook = function (next) {\n    return function (options) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        // The group should be staticly set to the default initial group as certain components\n        // (ex. Button and ButtonGroup) can be dynamically grouped under a new group (ex. TitleBar)\n        // We accept partial options so the validator should be called on merged new and old options\n        var mergedOptions = helper_1.getMergedProps(this.options, options);\n        var errors = updateValidator(this.app.localOrigin, this.defaultGroup, mergedOptions);\n        if (errors) {\n            throw Error_1.fromAction(utils_1.actionMessage(errors), Error_1.ActionType.INVALID_OPTIONS);\n        }\n        return next.apply(void 0, [options].concat(args));\n    };\n};\nexports.connectValidatorToDispatchHook = function (next) {\n    return function (action) {\n        var finalAction = dispatchValidator(action, this.localOrigin);\n        return next(finalAction);\n    };\n};\nexports.validatorMiddleware = function (hooks) {\n    hooks.set(client_1.LifecycleHook.UpdateAction, exports.connectValidatorToUpdateHook);\n    hooks.set(client_1.LifecycleHook.DispatchAction, exports.connectValidatorToDispatchHook);\n};\n"]},"metadata":{},"sourceType":"script"}